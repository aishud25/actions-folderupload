name: Unzip and Find All XML Files

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  scan-xml-files:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Unzip all .zip files recursively
        run: |
          echo "ðŸ” Searching for .zip files..."
          find . -type f -iname "*.zip" | while read zipfile; do
            echo "ðŸ“‚ Unzipping: $zipfile"
            unzip -o "$zipfile" -d "$(dirname "$zipfile")" || echo "âŒ Failed to unzip: $zipfile"
          done

      - name: List all .xml files in repository
        run: |
          echo "ðŸ“„ Searching for .xml files in all folders..."
          find . -type f -iname "*.xml" > xml_files.txt
          cat xml_files.txt

      - name: Upload XML file list
        uses: actions/upload-artifact@v3
        with:
          name: xml-file-list
          path: xml_files.txt
